# Test Data

## SRP254919

This data is intended for use in expression analysis downstream of the nf-core RNA-seq workflow. The objective is to make a subset sufficiently small to make the dataset manageable, but select genes in such a way that the data is still useful (e.g. we don't have a bunch of all-0 rows). [SRP254919](https://www.ebi.ac.uk/ena/browser/view/PRJNA622544?show=reads) is a small 6-sample mouse expression dataset that seemed a good candidate, and the data has been processed as follows.

### SRP254919.samplesheet.csv 

Sample sheet and FASTQ files derived by running [fetchngs](https://nf-co.re/fetchngs) with accession SRP254919. A 'treatment' column has been added to use in contrasts, along with a 'sample_number' column to be used as a blocking factor.

### SRP254919.gene_meta.tsv 

A simple two-column table of id/ symbol mappings for genes, useful in downstream tools expecting gene annotation.

### SRP254919.contrasts.csv  

An example file we might use to define contrasts over the above experiment. Variables per contrast are:

 * The sample sheet column used to define contrasts.
 * The value of the sample sheet contrast column used to identify reference samples.
 * The value of the sample sheet contrast column used to identify target/ treatment samples.
 * A comma-separated list of other columns to use as blocking variables (can empty)

### SRP254919.contrasts.yaml

The same example contrasts file as `SRP254919.contrasts.csv` converted to .yaml format.

### SRP254919.salmon.merged.gene_counts.top1000cov.tsv

Count matrix derived by running [rnaseq](https://nf-co.re/rnaseq) against the mouse genome GRCm38 with default parameters. The top 1000 most variable genes were selected from `salmon.merged.gene_counts` in R as follows: 

```r
expression <- read.table("salmon.merged.gene_counts.tsv")

# Remove rows with zeros
expression <- expression[apply(expression[,c(-1,-2)], 1, function(x) all(x > 0)), ]

# Sort by coefficient of variation
expression <- expression[order(apply(expression[,c(-1,-2)], 1, function(x) sd(x)/mean(x)), decreasing = TRUE), ]

write.table(expression[1:1000,], file = "SRP254919.salmon.merged.gene_counts.top1000cov.tsv", sep="\t", row.names = FALSE, quote = FALSE)
```

### SRP254919.salmon.merged.deseq2.results.tsv 

This is a result file generated by running DESeq2 with the above count file, contrasting the first three samples against the second.

## Datasets extracted from omnideconv/immunedeconv test datasets

`bulk_mat.tsv`: https://raw.githubusercontent.com/omnideconv/immunedeconv/refs/heads/master/tests/testthat/bulk_mat.tsv
`bulk_mat_mouse.tsv`: https://github.com/omnideconv/immunedeconv/raw/refs/heads/master/tests/testthat/bulk_mat_mouse.tsv

## Datasets extracted from nf-core/differentialabundance pipeline execution

### Test profile output data

`nf-core/differentialabundance` was executed with this command:

```bash
nextflow run nf-core/differentialabundance -r 9a84f4bf1e581425c0fcb7edcec772998265eeb1 -latest -profile docker,test --outdir results
```

- `Mus_musculus.anno.tsv` was extracted from the channel `VALIDATOR.out.feature_meta`.

- `SRP254919.samplesheet.sample_metadata.tsv` was extracted from the channel `VALIDATOR.out.sample_meta`.

- `all.normalised_counts.tsv` was extracted from the channel `ch_norm`, used as input for the process `CUSTOM_TABULARTOGSEAGCT`.

- `SRP254919.salmon.merged.gene_counts.top1000cov.assay.tsv` was extracted from the channel `ch_matrix_for_differential`, used as input for the process `CUSTOM_MATRIXFILTER`.

- `SRP254919.filtered.tsv` was extracted from the channel `CUSTOM_MATRIXFILTER.out.filtered`.

- `all.vst.tsv` was extracted from the channel `DESEQ2_DIFFERENTIAL.out.vst_counts`.

- `treatment_mCherry_hND6_.deseq2.results.tsv` was extracted from the channel `DESEQ2_DIFFERENTIAL.out.results`.

- `treatment_mCherry_hND6_.deseq2.results_filtered.tsv` was extracted from the channel `CUSTOM_FILTERDIFFERENTIALTABLE.out.filtered`.


### Test full profile output data

`nf-core/differentialabundance` was executed with this command:

```bash
nextflow run nf-core/differentialabundance -r  9a84f4bf1e581425c0fcb7edcec772998265eeb1  -profile docker,test_full --outdir results
```

- `study.filtered.tsv` was extracted from the channel `CUSTOM_MATRIXFILTER.out.filtered`.

- `Condition_genotype_WT_KO.deseq2.results_filtered.tsv` was extracted from the channel `CUSTOM_FILTERDIFFERENTIALTABLE.out.filtered`.
